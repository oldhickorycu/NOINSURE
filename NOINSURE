[Created by SYMFORM.CREATOR on 06/11/2007
 Driver           - NOINSURE
 Field Assignment - NOINSURE.INC
 Symform Commands - NOINSURE.SYMFORM
 Form file name   - NOINSURE.SFF

 SyRTS Number  :
 Credit Union  :
 Form          :
 Form Source   :

 Created By    :
 Created On    :

 Modified By   :
 Modified Date :
 Modifications :
]


WINDOWS

TARGET = ACCOUNT

DEFINE
  #INCLUDE "RD.GETDATA.DEF"
  #INCLUDE "RD.SYMFORM.DEF"

  #INCLUDE "RD.LOAN.DEF"
  #INCLUDE "RD.LOANPROJECT.DEF"
  #INCLUDE "RD.LOANAPP.DEF"
  #INCLUDE "RD.NAME.AND.ACCOUNT.DEF"
  #INCLUDE "CHARTERS.OLD.HICKORY.DEF"

  CUNAME          = CHARACTER
  CUNUMBER        = CHARACTER
  FORMNAME        = CHARACTER
  OTGID           = CHARACTER
  USEOPTICAL      = NUMBER
  PRINTOPTION     = NUMBER
  COPYQTY         = NUMBER
  DUPLEXTYPE      = NUMBER
  PAPERSIZETYPE   = NUMBER
  ORIENTATIONTYPE = NUMBER

  FORMDATA        = CHARACTER(80) ARRAY(012)
  TRUE            = 1
  FALSE           = 0
  CHECKED         = "1"
  UNCHECKED       = "0"
  COMBOVALUE      = CHARACTER(40) ARRAY(000,250)
  COMBOCODE       = NUMBER ARRAY(000,250)
  MLDATA          = CHARACTER(40) ARRAY(000,000)
  MLINDEX         = NUMBER ARRAY(012)

  USEOTGFLAG	= NUMBER
  DEBUG		= NUMBER
END


SETUP
  USEOTGFLAG	= TRUE
  PRINTOPTION	= 1
  QUOTE           = CTRLCHR(34)
  SYMFORMINPUT    = TRUE
  FORMSAVED       = FALSE
  FORMSBMT        = FALSE

  IF SYSWINDOWSLEVEL<2 THEN
   DO
    NEWLINE
    NEWLINE
    PRINT "SYMFORM REPGENS CAN ONLY BE RUN FROM SYMITAR FOR WINDOWS"
    NEWLINE
    NEWLINE
    TERMINATE
   END

  CALL LOADNAMEANDACCOUNTFIELDS
  #INCLUDE "RD.LOANAPP.SETUP"
  LPEFFECTIVEDATE='--/--/--'
[  CALL LOADLOANPROJECTFIELDS]
  CALL ASSIGNFIELDVARIABLES
  CALL UPDATESYMFORMFIELDS

  [ #PLACELOADSTICKY ]
[
  This is where you would place the call to load Sticky Notes from
  either Account, Share, Loan, or Loan Application record:
  CALL LOADSTICKYNOTESACCOUNT or
  CALL LOADSTICKYNOTESSHARE or
  CALL LOADSTICKYNOTESLOAN or
  CALL LOADSTICKYNOTESLOANAPP
  Only one procedure can be called. Make sure you have the
  corresponding INCLUDE file with the record definitions.
]

[
  This is where you would create custom tool bar items.
  Valid tool bar control types are 6=Button, 5=Combo Box, 8=List box.
  For example to create a single button:
  WINDOWSSEND(332,"TID=1,CT=6")
]

  IF PRINTOPTION = 2 THEN
  DO
    WINDOWSSEND(332,"MBNA=NOTHING")
    CALL GETRESPONSE
    WINDOWSSEND(332,"SAVE=DEFAULTPRINT")
    CALL GETRESPONSE
    WINDOWSSEND(332,"CLOSE,MIN")
    TERMINATE
  END

  IF DEBUG=TRUE THEN
  DO
    FOR FORMLOOP = 1 TO FIELDMAX
    DO
      WINDOWSSEND(332,"ID="+FORMAT("999",FORMLOOP)+",V=1,E=1")
    END
  END

  OTGTYPE=OTGLOANAPP
  CALL SENDBUTTON
    
  TEMPNUM = 1
  WINDOWSSEND(332,"SP=001,SF=001")
  WHILELIMIT = 100000
  WHILE (VALUE(RESPSF)>0 OR RESPSF="") AND CLOSEFORM = FALSE
   DO
    CALL GETRESPONSE
    CALL CLEARCBVALUES
    CALL PROCESSFIELDEVENT
    IF RESPCMD<>"" THEN         
     DO
      IF RESPCMD="SBMT" THEN
       DO
        WINDOWSSEND(332,"SBMT")  
        RESPID = "1"
        WHILE RESPVA<>"END" OR RESPID<>"0"
         DO
          CALL GETRESPONSE
          FORMDATA(VALUE(RESPID))=RESPVA
         END
[
        CALL UPDATEFIELDVARIABLES
]
        FORMSBMT  = TRUE

        #INCLUDE "RD.NAME.AND.ACCOUNT.FMP"
        CALL LOADNAMEANDACCOUNTFIELDS
        #INCLUDE "RD.LOANAPP.FMP"
        CALL LOADLOANAPPFIELDS

        [Additional FMPERFORM commands can be performed here]
[
        CALL ASSIGNFIELDVARIABLES
        CALL UPDATESYMFORMVALUES
]
        WINDOWSSEND(332,"MFLAG=0")
        WINDOWSSEND(332,"MBOK=ALL FIELDS SENT TO HOST")
       END

      IF RESPCMD="SAVE" THEN
       DO
        PRINTOTGOPTION=WITHDIALOG
        [DOCUMENTTYPE=]
        CALL PRINTANDOTG

        IF VALUE(RESPSAV)>0 THEN
          FORMSAVED = TRUE
        IF FORMSBMT = TRUE AND FORMSAVED = TRUE THEN
         DO
          WINDOWSSEND(332,"CLOSE,MIN")
          CLOSEFORM = TRUE
         END
       END
     END

    IF RESPTID<>"" THEN
      CALL PROCESSTOOLBAREVENT
   END
END


PRINT TITLE="TEST"
  SUPPRESSNEWLINE
END


[Whenever the user attempts to change fields by ether using the mouse or
 the tab key a number of pieces of data are sent to this procedure:
 RESPSF = Indicates the field ID that was attempted to be moved to.
 RESPID = Indicates the field ID the user was on.
 RESPVA = Indicates the value that was entered into the field.
 RESPSP = Indicates the page that was attempted to be moved to.
 RESPRD = Indicates the method used to move between field IDs.
 From the statement below you can see that normally SymForm just allows
 the action by changing focus to the requested field.

 This is where field validation could occur. For example if you didn't
 want the user to be able to leave field 10 until a value between
 6 and 18 was entered you could simply add
 IF VALUE(RESPID)=10 AND (VALUE(RESPVA)<6 OR VALUE(RESPVA)>18) THEN
   RESPSF="10"

 Some procedures to help validate common fields will be placed in
 RD.SYMFORM.PRO. The current ones are:

 FIXPHONENUMBER - This procedure will right justify a phone number and
                  ensure that it is 7 or 10 characters long.
                  Ex:  IF VALUE(RESPID)=5 THEN
                         CALL FIXPHONENUMBER
]
PROCEDURE PROCESSFIELDEVENT
  IF RESPSP<>"" THEN
    WINDOWSSEND(332,"SP="+RESPSP)
  IF RESPSF<>"" THEN
    WINDOWSSEND(332,"SF="+RESPSF)
END

[CHARTERS.OLD.HICKORY.PRO

DEFINE PROCEDURES USED IN THE CHARTERS FOR OLD HICKORY'S FORMS:

PRINT CHARTER - A "QUICK PRINT " BUTTON
OTG CHARTER - MAINTAIN A LOG OF FAILED SAVES TO OTG
FINANCE RECORD SCRUB - ELIMINATE FINANCE LIABILITY RECORDS UNDER $100.00

WORKS WITH CHARTERS.OLD.HICKORY.DEF
]

PROCEDURE SENDBUTTON
  WINDOWSSEND(332,"TID=1,CT=6,BM=PRINT1.BMP")                        [PLACE PRINT BUTTON]
  WINDOWSSEND(332,"TID=2,CT=6,BM=CLOSE.BMP")                        [PLACE CLOSE BUTTON]
END

PROCEDURE PROCESSTOOLBAREVENT                         [TOOL BAR BUTTON EVENTS]
 IF VALUE(RESPTID)=1 THEN
  DO
   PRINTOTGOPTION=WITHDIALOG
   CALL PRINTANDOTG

  END
 IF VALUE(RESPTID)=2 THEN
  DO
   WINDOWSSEND(332,"CLOSE,MIN")
   CLOSEFORM = TRUE
  END
END


PROCEDURE PRINTANDOTG
 IF USEOTGFLAG=TRUE THEN
  DO
   TEMPCHAR=ANUMBER
   CALL REMOVELEADINGZEROS
   IF OTGTYPE=OTGLOAN THEN
    DO
     WINDOWSSEND(332,"OTGN(0)=APPLICATION,OTG(0)=LOANS")
     WINDOWSSEND(332,"OTGN(1)=ACCT NO,OTG(1)="+TEMPCHAR)
     WINDOWSSEND(332,"OTGN(2)=NAME,OTG(2)="+SEGMENT(NLONGNAME(0),1,40))
     WINDOWSSEND(332,"OTGN(3)=TAX ID,OTG(3)="+NSSN(0))
     WINDOWSSEND(332,"OTGN(4)=LOAN ID,OTG(4)="+LID)
     WINDOWSSEND(332,"OTGN(5)=DOC TYPE,OTG(5)="+
       GETDATACHAR(GETDEFAULTLOAN,LTYPE,77))
     WINDOWSSEND(332,"OTGN(6)=DATE,OTG(6)="+
       FORMAT("99/99/99",SYSTEMDATE))
    END
   ELSE IF OTGTYPE=OTGLOANAPP THEN
    DO
     WINDOWSSEND(332,"OTGN(0)=APPLICATION,OTG(0)=LOANS")
     WINDOWSSEND(332,"OTGN(1)=ACCT NO,OTG(1)="+TEMPCHAR)
     WINDOWSSEND(332,"OTGN(2)=NAME,OTG(2)="+SEGMENT(NLONGNAME(0),1,40))
     WINDOWSSEND(332,"OTGN(3)=TAX ID,OTG(3)="+NSSN(0))
     WINDOWSSEND(332,"OTGN(4)=LOAN ID,OTG(4)="+LAID)
     WINDOWSSEND(332,"OTGN(5)=DOC TYPE,OTG(5)="+
       GETDATACHAR(GETDEFAULTLOAN,LALOANTYPE,77))
     WINDOWSSEND(332,"OTGN(6)=DATE,OTG(6)="+
       FORMAT("99/99/99",SYSTEMDATE))
    END
   ELSE IF OTGTYPE=OTGSHARE THEN
    DO
     WINDOWSSEND(332,"OTGN(0)=APPLICATION,OTG(0)=MEMBREC")
     WINDOWSSEND(332,"OTGN(1)=ACCT NO,OTG(1)="+TEMPCHAR)
     WINDOWSSEND(332,"OTGN(2)=NAME,OTG(2)="+SEGMENT(NLONGNAME(0),1,40))
     WINDOWSSEND(332,"OTGN(3)=TAX ID,OTG(3)="+NSSN(0))
     WINDOWSSEND(332,"OTGN(4)=DOC TYPE,OTG(4)="+DOCUMENTTYPE)
     [WINDOWSSEND(332,"OTGN(5)=DATE,OTG(5)="+
       FORMAT("99/99/99",SYSTEMDATE))]
    END
  END

 IF PRINTOTGOPTION=WITHDIALOG THEN
  DO
   WINDOWSSEND(332,"SAVE,DUPLEX="+DUPLEXFLAG)
   CALL GETRESPONSE
  END
 ELSE 
  DO
   WINDOWSSEND(332,"SAVE=DEFAULTPRINTSAVE,DUPLEX="+DUPLEXFLAG)
   CALL GETRESPONSE
  END

 IF CHARACTERSEARCH(RESPSAV,"-")=0 THEN
  FORMSAVED = TRUE
 ELSE
  DO
   CALL FAILEDOTG
   FORMSAVED = TRUE
  END
  FORMSAVED = TRUE

  IF PRINTOPTION = 0 AND FORMSBMT = TRUE AND FORMSAVED = TRUE THEN
   DO
    WINDOWSSEND(332,"CLOSE,MIN")
    CLOSEFORM = TRUE
   END
  ELSE IF PRINTOPTION = 1 AND FORMSAVED = TRUE THEN
   DO
    WINDOWSSEND(332,"CLOSE,MIN")
    CLOSEFORM = TRUE
   END

END


PROCEDURE FAILEDOTG

 IF PRINTOTGOPTION=WITHDIALOG THEN
  DO
   WINDOWSSEND(332,"SAVE=DEFAULTPRINT,DUPLEX="+DUPLEXFLAG)
   CALL GETRESPONSE
  END
 ELSE 
  DO
   WINDOWSSEND(332,"SAVE=DEFAULTPRINT,COPIES=2,DUPLEX="+DUPLEXFLAG)
   CALL GETRESPONSE
  END

   POPUPMESSAGE(1,"This document did not save to OTG, a second copy is being printed.")

   FNAME  ="FAILEDOTGLOG."+FORMAT("99999999",SYSTEMDATE)+"."+FORMAT("9999",SYSUSERNUMBER)
   FILETYPE  ="LETTER"
   FMODE  ="READ"
   FILEOPEN(FILETYPE,FNAME,FMODE,FNUMBER,FERROR)
   IF FERROR="" THEN
    DO
     FILECLOSE(FNUMBER,FERROR)
     IF FERROR<>"" THEN
      CALL FILEERROR
    END
   ELSE
    DO
     FILECREATE("LETTER",FNAME,FERROR)
     IF FERROR<>"" THEN
      CALL FILEERROR
    END
   IF OTGTYPE=OTGLOAN THEN
    DO
     FLINE1="1LOANS   "+
           ACCOUNT:NUMBER+LID+
           NLONGNAME(0)+SEGMENT(SPACE40,1,40-LENGTH(NLONGNAME(0)))+
           NSSN(0)
     FLINE2="2"+GETDATACHAR(GETDEFAULTLOAN,LALOANTYPE,77)+
           SEGMENT(SPACE40,1,40-LENGTH(GETDATACHAR(GETDEFAULTLOAN,LALOANTYPE,77)))+
           FORMAT("99/99/9999",SYSTEMDATE)+
           FORMAT("9999",SYSACTUALTIME)+
           FORMAT("9999",GETDATANUMBER(GETCONSOLEBRANCH,SYSCONSOLENUM))+
           FORMAT("9999",SYSUSERNUMBER)
    END
   ELSE IF OTGTYPE=OTGLOANAPP THEN
    DO
     IF LAID="" THEN
      LAID="XX"
     FLINE1="1LOANS   "+
           ACCOUNT:NUMBER+LAID+
           NLONGNAME(0)+SEGMENT(SPACE40,1,40-LENGTH(NLONGNAME(0)))+
           NSSN(0)
     FLINE2="2"+GETDATACHAR(GETDEFAULTLOAN,LALOANTYPE,77)+
           SEGMENT(SPACE40,1,40-LENGTH(GETDATACHAR(GETDEFAULTLOAN,LALOANTYPE,77)))+
           FORMAT("99/99/9999",SYSTEMDATE)+
           FORMAT("9999",SYSACTUALTIME)+
           FORMAT("9999",GETDATANUMBER(GETCONSOLEBRANCH,SYSCONSOLENUM))+
           FORMAT("9999",SYSUSERNUMBER)
    END
   ELSE IF OTGTYPE=OTGSHARE THEN
    DO
     FLINE1="1MEMBREC "+
           ACCOUNT:NUMBER+"  "+
           NLONGNAME(0)+SEGMENT(SPACE40,1,40-LENGTH(NLONGNAME(0)))+
           NSSN(0)
     FLINE2="2"+DOCUMENTTYPE+SEGMENT(SPACE40,1,40-LENGTH(DOCUMENTTYPE))+ 
           FORMAT("99/99/9999",SYSTEMDATE)+
           FORMAT("9999",SYSACTUALTIME)+
           FORMAT("9999",GETDATANUMBER(GETCONSOLEBRANCH,SYSCONSOLENUM))+
           FORMAT("9999",SYSUSERNUMBER)
    END
   FMODE  ="APPEND"
   FILEOPEN(FILETYPE,FNAME,FMODE,FNUMBER,FERROR)
   FILEWRITELINE(FNUMBER,FLINE1,FERROR)
   FILEWRITELINE(FNUMBER,FLINE2,FERROR)
   IF FERROR<>"" THEN
    CALL FILEERROR
   FILECLOSE(FNUMBER,FERROR)
   IF FERROR<>"" THEN
    CALL FILEERROR
END


PROCEDURE FILEERROR
 POPUPMESSAGE(2,"OTG File error: "+FERROR)
 FILECLOSE(FNUMBER,FERROR)
END


  #INCLUDE "RD.SYMFORM.PRO"
  #INCLUDE "RD.NAME.AND.ACCOUNT.PRO"
  #INCLUDE "RD.LOANAPP.PRO"
  #INCLUDE "RD.LOANPROJECT.PRO"
  #INCLUDE "NOINSURE.INC"
  #INCLUDE "NOINSURE.SYMFORM"



